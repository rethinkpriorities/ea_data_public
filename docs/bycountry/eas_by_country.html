<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.243">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>eas_by_country</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="eas_by_country_files/libs/clipboard/clipboard.min.js"></script>
  <script src="eas_by_country_files/libs/quarto-html/quarto.js"></script>
  <script src="eas_by_country_files/libs/quarto-html/popper.min.js"></script>
  <script src="eas_by_country_files/libs/quarto-html/tippy.umd.min.js"></script>
  <script src="eas_by_country_files/libs/quarto-html/anchor.min.js"></script>
  <link href="eas_by_country_files/libs/quarto-html/tippy.css" rel="stylesheet">
  <link id="quarto-text-highlighting-styles" href="eas_by_country_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="eas_by_country_files/libs/bootstrap/bootstrap.min.js"></script>
  <link href="eas_by_country_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="eas_by_country_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script async="" src="https://hypothes.is/embed.js"></script>
  <script src="eas_by_country_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
  <link href="eas_by_country_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
  <script src="eas_by_country_files/libs/datatables-binding-0.20/datatables.js"></script>
  <script src="eas_by_country_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="eas_by_country_files/libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
  <link href="eas_by_country_files/libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
  <script src="eas_by_country_files/libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
  <link href="eas_by_country_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
  <script src="eas_by_country_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of contents</h2>
<ul>
<li><a href="#eas-by-country-understanding-drivers-the-search-for-outliers-and-untapped-markets" id="toc-eas-by-country-understanding-drivers-the-search-for-outliers-and-untapped-markets" class="nav-link active" data-scroll-target="#eas-by-country-understanding-drivers-the-search-for-outliers-and-untapped-markets"> <span class="header-section-number">1</span> EAS by country: understanding drivers, the search for outliers and untapped ‘markets’</a>
<ul class="collapse">
<li><a href="#bring-in-country-level-data-input-by-hand-etc" id="toc-bring-in-country-level-data-input-by-hand-etc" class="nav-link" data-scroll-target="#bring-in-country-level-data-input-by-hand-etc"> <span class="header-section-number">1.1</span> Bring in country level data (input by hand, etc)</a></li>
<li><a href="#further-english-language-features-and-imputation" id="toc-further-english-language-features-and-imputation" class="nav-link" data-scroll-target="#further-english-language-features-and-imputation"> <span class="header-section-number">1.2</span> Further English language features and imputation</a>
<ul class="collapse">
<li><a href="#other-imputation" id="toc-other-imputation" class="nav-link" data-scroll-target="#other-imputation"> <span class="header-section-number">1.2.1</span> Other imputation</a></li>
</ul></li>
</ul></li>
<li><a href="#simple-models" id="toc-simple-models" class="nav-link" data-scroll-target="#simple-models"> <span class="header-section-number">2</span> Simple models</a>
<ul class="collapse">
<li><a href="#plotting-predicted-versus-actual-levels-and-largest-outliers" id="toc-plotting-predicted-versus-actual-levels-and-largest-outliers" class="nav-link" data-scroll-target="#plotting-predicted-versus-actual-levels-and-largest-outliers"> <span class="header-section-number">2.1</span> Plotting predicted versus actual levels and largest ‘outliers’</a>
<ul class="collapse">
<li><a href="#linear" id="toc-linear" class="nav-link" data-scroll-target="#linear"> <span class="header-section-number">2.1.1</span> Linear</a></li>
<li><a href="#log-log-per-capita" id="toc-log-log-per-capita" class="nav-link" data-scroll-target="#log-log-per-capita"> <span class="header-section-number">2.1.2</span> Log-log per capita</a></li>
<li><a href="#exponential-quasi-poisson" id="toc-exponential-quasi-poisson" class="nav-link" data-scroll-target="#exponential-quasi-poisson"> <span class="header-section-number">2.1.3</span> Exponential Quasi-Poisson</a></li>
</ul></li>
<li><a href="#table-of-residuals" id="toc-table-of-residuals" class="nav-link" data-scroll-target="#table-of-residuals"> <span class="header-section-number">2.2</span> Table of residuals</a></li>
</ul></li>
</ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<section id="eas-by-country-understanding-drivers-the-search-for-outliers-and-untapped-markets" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> EAS by country: understanding drivers, the search for outliers and untapped ‘markets’</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>here <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnoodling)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinkpriorities)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(broom,  dplyr, ggplot2,  ggrepel, janitor, kableExtra, readr, tidyr, tidyselect, tidymodels, tidyverse, plotly, DT,  <span class="at">install =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(huxtable)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(modelr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(httr)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(viridis, ggsci)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="bring-in-country-level-data-input-by-hand-etc" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="bring-in-country-level-data-input-by-hand-etc"><span class="header-section-number">1.1</span> Bring in country level data (input by hand, etc)</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"supplementary"</span>, <span class="st">"EAs per capita across time - Compiled Dataset.csv"</span>), <span class="at">skip=</span><span class="dv">1</span>, <span class="at">na=</span><span class="fu">c</span>(<span class="st">"N/A"</span>))</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(across(matches("GDP|"), as.numeric)) %&gt;% </span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">easpercap =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(EAspercapita_2018, EAspercapita_2019, EAspercapita_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_easpercap =</span> <span class="fu">log</span>(easpercap),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">eas_3yr_avg =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(EAs_2018, EAs_2019, EAs_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_3yr_avg =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(Population_2018, Population_2019, Population_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdpppp_3yr_avg =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(GDPPPP_2018, GDPPPP_2019, GDPPPP_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdppop_3yr_avg =</span>  gdpppp_3yr_avg<span class="sc">/</span>population_3yr_avg</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="further-english-language-features-and-imputation" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="further-english-language-features-and-imputation"><span class="header-section-number">1.2</span> Further English language features and imputation</h2>
<p>UK Government classification of ‘majority native English speaking’ according to <a href="https://www.northampton.ac.uk/international/english-language-requirements/majority-native-english-speaking-countries/">university websites</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>uk_govt_classified_english_speaking <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"supplementary"</span>, <span class="st">"uk_govt_classified_english_speaking.csv"</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">country=</span><span class="fu">tolower</span>(X1)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_uk_english =</span><span class="dv">1</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(uk_govt_classified_english_speaking, <span class="at">by=</span><span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_uk_english =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    country<span class="sc">==</span><span class="st">"united states"</span> <span class="sc">~</span> <span class="cn">TRUE</span>, <span class="co">#USA named differently in other data, needed fixing</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    country<span class="sc">==</span><span class="st">"bermuda"</span> <span class="sc">~</span> <span class="cn">TRUE</span>, <span class="co">#an obvious omission</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(d_uk_english) <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">FALSE</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following dataset is extracted from <a href="https://en.wikipedia.org/wiki/EF_English_Proficiency_Index" class="uri">https://en.wikipedia.org/wiki/EF_English_Proficiency_Index</a>, through a <a href="https://www.kaggle.com/datasets/mathurinache/ef-english-proficiency-index?resource=download">Kaggler</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>EF_English_Proficiency_Index <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"supplementary"</span>, <span class="st">"EF_English_Proficiency_Index.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"ef_epi_19"</span><span class="ot">=</span> <span class="st">`</span><span class="at">2019 Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country=</span><span class="fu">tolower</span>(Country),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">country =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"mainland china"</span> <span class="sc">~</span> <span class="st">"china"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"russia"</span> <span class="sc">~</span> <span class="st">"russian federation"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"hong kong"</span> <span class="sc">~</span> <span class="st">"hong kong sar china"</span>,</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> country</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">%&gt;%</span> </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(country, ef_epi_19)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The two English prevalence/proficiency measures cover different countries, each with many missing values. As a compromise measure, we average these two, taking the nonmissing value of one where the other is missing, a feature we call <code>english_av</code>. Finally, where both are missing for a country, we take the average of the above average for the “Cultural Zone” of the country. (Code chunk below).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(EF_English_Proficiency_Index, <span class="at">by=</span><span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">english_speakers_pctl =</span> <span class="fu">rank</span>(EnglishSpeakers, <span class="at">ties.method =</span> <span class="fu">c</span>(<span class="st">"average"</span>), <span class="at">na.last=</span><span class="st">"keep"</span>)<span class="sc">/</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(EnglishSpeakers)),</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">ef_epi_19_pctl =</span> <span class="fu">rank</span>(ef_epi_19, <span class="at">ties.method =</span> <span class="fu">c</span>(<span class="st">"average"</span>), <span class="at">na.last=</span><span class="st">"keep"</span>)<span class="sc">/</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(ef_epi_19)),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>eas_by_country_all<span class="sc">$</span>english_av <span class="ot">&lt;-</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowMeans</span>(eas_by_country_all <span class="sc">%&gt;%</span> <span class="fu">select</span>(ef_epi_19_pctl, english_speakers_pctl) <span class="sc">%&gt;%</span> as.matrix, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> <span class="co">#impute to regional average where missing</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CulturalZone) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">english_av_zone =</span> <span class="fu">mean</span>(english_av, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">english_av =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(english_av) <span class="sc">~</span> english_av_zone,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> english_av)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># next take the average of the nonmissing percentiles</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>What does this look like:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, <span class="fu">matches</span>(<span class="st">"english|English|ef_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="fu">across</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">class =</span> <span class="st">'cell-border stripe'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-c9bea0e07f44c1984ef1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c9bea0e07f44c1984ef1">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101"],["angola","argentina","australia","austria","barbados","belarus","belgium","bermuda","brazil","bulgaria","burkina faso","cameroon","canada","central african republic","chile","china","colombia","costa rica","croatia","cuba","cyprus","czech republic","democratic republic of the congo","denmark","ecuador","egypt","el salvador","estonia","ethiopia","faroe islands","finland","france","georgia","germany","ghana","greece","guatemala","haiti","hong kong sar china","hungary","iceland","india","ireland","israel","italy","japan","kazakhstan","kenya","latvia","lebanon","lesotho","liberia","lithuania","luxembourg","malaysia","malta","mexico","morocco","myanmar","namibia","netherlands","new zealand","nigeria","norway","oman","pakistan","palestinian territories","papua new guinea","peru","philippines","poland","portugal","qatar","romania","russian federation","rwanda","saudi arabia","senegal","serbia","sierra leone","singapore","slovakia","slovenia","south africa","south korea","spain","sweden","switzerland","taiwan","north macedonia","trinidad and tobago","tunisia","turkey","uganda","united kingdom","united arab emirates","tanzania","uruguay","united states","vietnam","zambia"],[null,6.52,97,73,98.57,null,60,96.92,5,25,null,38,85.63,null,9.53,1,4.22,null,49,null,73,27,null,91,null,35,null,50,null,null,70,36,null,70,66.67,51,null,null,null,20,null,12.1,98.37,84.97,40,null,15.4,18.83,46,40,27.86,82.67,38,56,62.57,89,12.9,14,null,17.24,90,97.82,53.34,90,null,49,null,49.76,null,92.58,37,27,null,31,5.48,15,null,null,null,83.53,80,26,59,31,null,22,90,61.28,null,null,87.74,null,17,8.1,97.74,null,9.89,null,95.81,null,16],[false,false,true,false,true,false,false,true,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,false,false,true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,true,false,false,false,true,false,false,false,true,false,false],[44.54,58.38,null,64.11,null,52.39,63.09,null,50.1,58.97,null,46.28,null,null,52.89,53.44,48.75,57.38,63.07,52.7,null,59.3,null,67.87,46.57,47.11,50.09,58.29,49.64,null,65.34,57.25,50.62,63.77,null,59.87,52.5,null,55.63,61.86,null,55.49,null,null,55.31,51.51,43.83,60.51,56.85,null,null,null,60.11,64.03,58.55,null,48.99,47.19,46,null,70.27,null,58.26,67.93,44.39,51.41,null,null,50.22,60.14,63.76,63.14,46.79,61.36,52.14,null,41.6,null,61.3,null,66.82,58.82,null,65.38,55.04,55.46,68.74,60.23,54.18,null,null,49.04,46.81,null,null,48.19,null,54.08,null,51.57,null],[null,0.07,0.94,0.72,1,null,0.62,0.93,0.04,0.29,null,0.44,0.8,null,0.1,0.01,0.03,null,0.51,null,0.72,0.33,null,0.88,null,0.39,null,0.55,null,null,0.69,0.41,null,0.69,0.67,0.57,null,null,null,0.26,null,0.13,0.99,0.78,0.47,null,0.19,0.25,0.49,0.47,0.35,0.75,0.44,0.59,0.65,0.83,0.14,0.16,null,0.23,0.86,0.97,0.58,0.86,null,0.51,null,0.54,null,0.9,0.42,0.33,null,0.37,0.06,0.17,null,null,null,0.77,0.74,0.3,0.61,0.37,null,0.28,0.86,0.64,null,null,0.81,null,0.22,0.09,0.96,null,0.12,null,0.91,null,0.2],[0.06,0.62,null,0.9,null,0.37,0.82,null,0.26,0.66,null,0.09,null,null,0.41,0.43,0.19,0.57,0.81,0.4,null,0.68,null,0.96,0.1,0.15,0.25,0.6,0.24,null,0.91,0.56,0.29,0.87,null,0.69,0.38,null,0.53,0.79,null,0.51,null,null,0.49,0.32,0.03,0.75,0.54,null,null,null,0.71,0.88,0.63,null,0.21,0.16,0.07,null,1,null,0.59,0.97,0.04,0.31,null,null,0.28,0.72,0.85,0.84,0.12,0.78,0.35,null,0.01,null,0.76,null,0.94,0.65,null,0.93,0.47,0.5,0.99,0.74,0.46,null,null,0.22,0.13,null,null,0.18,null,0.44,null,0.34,null],[0.06,0.35,0.94,0.81,1,0.37,0.72,0.93,0.15,0.48,0.3,0.27,0.8,0.46,0.26,0.22,0.11,0.57,0.66,0.4,0.72,0.5,0.46,0.92,0.1,0.27,0.25,0.58,0.24,0.46,0.8,0.48,0.29,0.78,0.67,0.63,0.38,0.29,0.53,0.53,0.85,0.32,0.99,0.78,0.48,0.32,0.11,0.5,0.52,0.47,0.35,0.75,0.57,0.74,0.64,0.83,0.18,0.16,0.07,0.23,0.93,0.97,0.58,0.91,0.04,0.41,0.46,0.54,0.28,0.81,0.64,0.58,0.12,0.57,0.21,0.17,0.01,0.46,0.76,0.77,0.84,0.48,0.61,0.65,0.47,0.39,0.92,0.69,0.46,0.43,0.81,0.22,0.17,0.09,0.96,0.18,0.12,0.44,0.91,0.34,0.2],[0.46,0.29,0.93,0.57,0.46,0.43,0.57,0.46,0.29,0.43,0.3,0.46,0.93,0.46,0.29,0.39,0.29,0.46,0.57,0.46,0.46,0.57,0.46,0.85,0.29,0.3,0.46,0.57,0.3,0.46,0.85,0.57,0.43,0.85,0.3,0.43,0.29,0.29,0.39,0.57,0.85,0.59,0.93,0.59,0.57,0.39,0.43,0.46,0.46,0.3,0.46,0.46,0.57,0.46,0.59,0.46,0.29,0.46,0.07,0.46,0.85,0.93,0.3,0.85,0.46,0.3,0.46,0.46,0.29,0.46,0.57,0.57,0.46,0.43,0.43,0.3,0.3,0.46,0.43,0.46,0.59,0.57,0.57,0.46,0.39,0.57,0.85,0.85,0.46,0.43,0.29,0.3,0.3,0.46,0.93,0.46,0.3,0.46,0.93,0.59,0.46]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>EnglishSpeakers<\/th>\n      <th>d_uk_english<\/th>\n      <th>ef_epi_19<\/th>\n      <th>english_speakers_pctl<\/th>\n      <th>ef_epi_19_pctl<\/th>\n      <th>english_av<\/th>\n      <th>english_av_zone<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,4,5,6,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="other-imputation" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="other-imputation"><span class="header-section-number">1.2.1</span> Other imputation</h3>
<p>We quickly impute all other features where missing by taking the average for the “Cultural Zone” (relevant for below models: <code>Emancipative</code> and <code>Secular</code>). The data frame with imputed values is called <code>eas_by_country_all_i</code>, the one without imputations is <code>eas_by_country_all</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#imputation where missing</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>eas_by_country_all_i <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CulturalZone) <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">median</span>(x, <span class="at">na.rm =</span> T), x)) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="simple-models" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Simple models</h1>
<p>I typically like to define the ‘key features’ and ‘key outcomes’ up top. I started on this here, but didn’t do it too much.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#key features</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>features_percap <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdppop_3yr_avg"</span>, <span class="st">"d_uk_english"</span>, <span class="st">"english_av"</span>, <span class="st">"Emancipative"</span>, <span class="st">"Secular"</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"population_3yr_avg"</span>, features_percap)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>log_features_percap <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"log(gdppop_3yr_avg)"</span>, <span class="st">"d_uk_english"</span>, <span class="st">"log(english_av)"</span>,  <span class="st">"log(Emancipative)"</span>, <span class="st">"log(Secular)"</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>log_features <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"log(population_3yr_avg)"</span>, log_features_percap)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#This makes complete cases only:</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co">#eas_by_country_all_nomissing &lt;- eas_by_country_all %&gt;%  na.omit(features)</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(eas_by_country_all) <span class="ot">&lt;-</span> eas_by_country_all<span class="sc">$</span>country  </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(eas_by_country_all_i) <span class="ot">&lt;-</span> eas_by_country_all_i<span class="sc">$</span>country  </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Using rownames is an annoying workaround to get labels in graphs later. There's probably a better way.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Below, we construct models</p>
<ul>
<li>imputed and complete-case-only data,</li>
<li>with linear, log transformations, and exponential (quasi-Poisson) specifications</li>
<li>with level and per-capita outcomes.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, features), .) </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>model_linear_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, features), .) </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>model_log_eapercap <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(easpercap<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"log_easpercap"</span>, log_features_percap), .) </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>model_log_eapercap_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(easpercap<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"log_easpercap"</span>, log_features_percap), .)   </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>model_eapercap <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"easpercap*1000*100"</span>, features_percap), .)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>model_eapercap_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"easpercap*1000*100"</span>, features_percap), .)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>model_ea_psn <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span>  <span class="fu">glm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, log_features), <span class="at">family=</span>quasipoisson, <span class="at">data =</span>.) </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>model_ea_psn_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">glm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, log_features), <span class="at">family=</span>quasipoisson, <span class="at">data =</span>.) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We put the coefficients of these models into summary tables below:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ea_by_country_all_models_table <span class="ot">&lt;-</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">huxreg</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Linear"</span> <span class="ot">=</span> model_linear, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span> model_linear_i,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log per-capita, no 0's"</span> <span class="ot">=</span> model_log_eapercap, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span>  model_log_eapercap_i,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Per `100k` capita"</span> <span class="ot">=</span> model_eapercap, </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span> model_eapercap_i, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Quasi-Poisson"</span> <span class="ot">=</span> model_ea_psn,</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span> model_ea_psn_i) <span class="sc">%&gt;%</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_number_format</span>(<span class="at">row=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">col=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">value=</span><span class="st">"%#.2f"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set_bold</span>(<span class="dv">1</span>, everywhere) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_bottom_border</span>(<span class="dv">1</span>, everywhere) <span class="sc">%&gt;%</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_caption_pos</span>(<span class="st">"top"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_caption</span>(<span class="st">"EAs by country: Models"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_col_width</span>(<span class="fu">c</span>(.<span class="dv">25</span>, <span class="fu">rep</span>(.<span class="dv">13</span>,<span class="dv">8</span>)))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p></p><table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; ; margin-left: auto; margin-right: auto;  " id="tab:ea_by_country_all_models_table">
<caption style="caption-side: top; text-align: center;">EAs by country: Models</caption><colgroup><col style="width: 25%"><col style="width: 13%"><col style="width: 13%"><col style="width: 13%"><col style="width: 13%"><col style="width: 13%"><col style="width: 13%"><col style="width: 13%"><col style="width: 13%"></colgroup><tbody><tr>
<th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;"></th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Linear</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">... imputed</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">log per-capita, no 0's</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">... imputed</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Per `100k` capita</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">... imputed</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">Quasi-Poisson</th><th style="vertical-align: top; text-align: center; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: bold;">... imputed</th></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(Intercept)</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">28.56&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-33.65&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-9.52 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-10.60 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.23 *</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.27 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-5.33 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-6.83 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(53.17)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(38.16)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.80)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.67)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.11)&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.07)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1.50)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.98)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">population_3yr_avg</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.00)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.00)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">gdppop_3yr_avg</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1288.24&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">142.18&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.11&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.73&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(720.86)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(335.75)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1.51)&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.62)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">d_uk_englishTRUE</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">208.10 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">101.04 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.92&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.76&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.17 *</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.06&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.03 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.89 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(36.79)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(25.81)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.52)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.48)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.08)&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.05)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.21)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.18)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">english_av</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.67&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-11.92&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.10&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.05&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(56.52)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(35.59)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.12)&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.07)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Emancipative</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-52.89&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">195.80&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.73 *</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.96 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(138.16)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(103.37)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.29)&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.19)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">Secular</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-106.69&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-139.21&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.31&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-0.40&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(151.51)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(131.34)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.32)&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.24)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log(gdppop_3yr_avg)</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.93 **&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.48 **&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.02 **&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.80 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.31)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.16)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.30)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.18)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log(english_av)</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.56&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.50 *&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.01 *&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1.14 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.31)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.19)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.40)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.31)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log(Emancipative)</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">4.69 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">5.23 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.66 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">3.79 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(1.05)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.94)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.87)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.74)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log(Secular)</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.25&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.27&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.31&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-1.16&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.91)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.89)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.91)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.82)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">log(population_3yr_avg)</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.74 ***</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.81 ***</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;"></th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.06)&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">(0.05)&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">N</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">63.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">101.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">52.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">73.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">63.00&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">101.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">63.00&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">101.00&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">R2</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.50&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.27&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.81&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.75&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.51&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">0.49&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">logLik</th><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-352.98&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-562.17&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-72.10&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-108.88&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">35.01&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">72.69&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">AIC</th><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">721.95&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">1140.35&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">158.20&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">231.77&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-56.02&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">-131.38&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.8pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr>
<th colspan="9" style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.8pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 6pt; font-weight: normal;"> *** p &lt; 0.001;  ** p &lt; 0.01;  * p &lt; 0.05.</th></tr>
</tbody></table>
<p></p>
</div>
</div>
<p>Next, we add the predicted values to the basic data set (imputed and non), to later make tables of predictions, and residuals, and share that data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#the repetition for both data sets below is rubbish -- I should use 'map' instead</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>eas_by_country_all_m_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear, <span class="at">var =</span> <span class="st">"pred_linear"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear_i, <span class="at">var =</span> <span class="st">"pred_linear_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap, <span class="at">var =</span> <span class="st">"pred_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap_i, <span class="at">var =</span> <span class="st">"pred_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap, <span class="at">var =</span> <span class="st">"pred_log_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap_i, <span class="at">var =</span> <span class="st">"pred_log_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn, <span class="at">var =</span> <span class="st">"pred_psn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn_i, <span class="at">var =</span> <span class="st">"pred_psn_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_pred_log_eapercap_xmil =</span> <span class="fu">exp</span>(pred_log_eapercap)<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_eapercap_permil =</span> pred_eapercap<span class="sc">*</span><span class="dv">10</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_eapercap_permil_i =</span> pred_eapercap_i<span class="sc">*</span><span class="dv">10</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">easpercap_permil =</span> easpercap<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>eas_by_country_all_m <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear, <span class="at">var =</span> <span class="st">"pred_linear"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear_i, <span class="at">var =</span> <span class="st">"pred_linear_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap, <span class="at">var =</span> <span class="st">"pred_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap_i, <span class="at">var =</span> <span class="st">"pred_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap, <span class="at">var =</span> <span class="st">"pred_log_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap_i, <span class="at">var =</span> <span class="st">"pred_log_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn, <span class="at">var =</span> <span class="st">"pred_psn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn_i, <span class="at">var =</span> <span class="st">"pred_psn_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_pred_log_eapercap_xmil =</span> <span class="fu">exp</span>(pred_log_eapercap)<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_eapercap_permil =</span> pred_eapercap<span class="sc">*</span><span class="dv">10</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">easpercap_permil =</span> easpercap<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="plotting-predicted-versus-actual-levels-and-largest-outliers" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="plotting-predicted-versus-actual-levels-and-largest-outliers"><span class="header-section-number">2.1</span> Plotting predicted versus actual levels and largest ‘outliers’</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>devplotopts <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>), </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> country),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">box.padding   =</span> <span class="fl">0.3</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">point.padding =</span> <span class="fl">0.4</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.color =</span> <span class="st">'grey50'</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span><span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">'grey'</span>),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(), </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"H"</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We plot the predicted and actual numbers (or population shares) of EAs for each country, for most of the models. For each, we first plot the ‘complete cases’ only, and then the models with imputed missing values of features.</p>
<p>In each case countries above the grey degree line represent ‘overperformers’ relative to prediction and those below it ‘underperformers’.</p>
<p>We color the country dots based on their Englis prevalence and proficiency score.</p>
<section id="linear" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="linear"><span class="header-section-number">2.1.1</span> Linear</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ea_dev_linear <span class="ot">&lt;-</span> model_linear <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear model, log scales): Predicted, actual, no imputation"</span>) </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_linear-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ea_dev_linear_i <span class="ot">&lt;-</span> model_linear_i <span class="sc">%&gt;%</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        devplotopts <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span> </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear, log scales): Predicted, actual, Imputed where missing"</span>) </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_linear-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>resid_threshold <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>minEA_threshold <span class="ot">&lt;-</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next we isolate the ‘largest positive or negative outliers’; the countries that are most ‘surprising’ to the model; more than 15 above or below prediction. Here we also leave out countries with fewer than 10 EAs as well as fewer than 10 predicted EAs.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ea_outliers_linear <span class="ot">&lt;-</span> model_linear <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span>  devplotopts <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>(eas_3yr_avg), <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear, log scales): Largest residuals, no imputation"</span>) </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/ea_outliers_linear-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ea_outliers_linear_i <span class="ot">&lt;-</span> model_linear_i <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span> devplotopts <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear, log scales): Largest residuals, Imputed where missing"</span>) </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/ea_outliers_linear-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>^[In the final graph above it looks like there are more negative than positive residuals. However, note these are presented on a log scale, and thus the observations above the line are ‘more overperforming’ than those just below the line.</p>
</section>
<section id="log-log-per-capita" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="log-log-per-capita"><span class="header-section-number">2.1.2</span> Log-log per capita</h3>
<p><em>(Note, I skipped plotting linear per-capita models for space)</em></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_log <span class="ot">&lt;-</span> model_log_eapercap <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span> log_easpercap, <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita, log model: Predicted, actual, no imputation"</span>) </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_log_plot-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_log_i <span class="ot">&lt;-</span> model_log_eapercap_i <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>log_easpercap, <span class="at">color=</span>english_av) <span class="sc">+</span> </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log EAS per capita: Predicted, actual, Imputed where missing"</span>) </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_log_plot-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_log <span class="ot">&lt;-</span> model_log_eapercap <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> .<span class="dv">75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span><span class="dv">10</span> <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>(<span class="st">`</span><span class="at">log_easpercap</span><span class="st">`</span>), <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span><span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log EAS per capita: Largest residuals, no imputation"</span>) </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_log_plot-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_log_i <span class="ot">&lt;-</span> model_log_eapercap_i <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> .<span class="dv">75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span><span class="st">`</span><span class="at">log_easpercap</span><span class="st">`</span>, <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">intercept =</span><span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log EAS per capita: Largest residuals, Imputed where missing"</span>) </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_log_plot-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="exponential-quasi-poisson" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="exponential-quasi-poisson"><span class="header-section-number">2.1.3</span> Exponential Quasi-Poisson</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_qp <span class="ot">&lt;-</span> model_ea_psn <span class="sc">%&gt;%</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP model - EAs: predicted, actual, no imputation"</span>) </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_qp_plot-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_qp_i <span class="ot">&lt;-</span> model_ea_psn_i <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span> </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP - EAs: Predicted, actual, Imputed where missing"</span>) </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_qp_plot-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_qp <span class="ot">&lt;-</span> model_ea_psn <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">.resid =</span>  eas_3yr_avg <span class="sc">-</span> .fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>(eas_3yr_avg), <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP = EAs: Largest residuals, no imputation"</span>) </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_qp_plot-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_qp_i <span class="ot">&lt;-</span> model_ea_psn_i <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">.resid =</span>  eas_3yr_avg <span class="sc">-</span> .fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span>  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP - EAss: Largest residuals, Imputed where missing"</span>) </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="eas_by_country_files/figure-html/model_eapercap_qp_plot-4.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="table-of-residuals" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="table-of-residuals"><span class="header-section-number">2.2</span> Table of residuals</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  eas_v_predicted <span class="ot">&lt;-</span> eas_by_country_all_m_i <span class="sc">%&gt;%</span>  </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_linear =</span> eas_3yr_avg <span class="sc">-</span> pred_linear,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_linear_i =</span> eas_3yr_avg <span class="sc">-</span> pred_linear_i,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_permln =</span> easpercap_permil <span class="sc">-</span> pred_eapercap_permil,</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_permln_i =</span> easpercap_permil <span class="sc">-</span> pred_eapercap_permil_i,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_log_per =</span> easpercap_permil <span class="sc">-</span> <span class="fu">exp</span>(pred_log_eapercap),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_log_per_i =</span> easpercap_permil <span class="sc">-</span> <span class="fu">exp</span>(pred_log_eapercap_i),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_psn =</span> eas_3yr_avg <span class="sc">-</span> pred_psn,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_psn_i =</span> eas_3yr_avg <span class="sc">-</span> pred_psn_i</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(country, population_3yr_avg, eas_3yr_avg, easpercap_permil, pred_linear, <span class="fu">starts_with</span>(<span class="st">"resid_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">class =</span> <span class="st">'cell-border stripe'</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="htmlwidget-f27058de8cc78777f03e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f27058de8cc78777f03e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101"],["angola","argentina","australia","austria","barbados","belarus","belgium","bermuda","brazil","bulgaria","burkina faso","cameroon","canada","central african republic","chile","china","colombia","costa rica","croatia","cuba","cyprus","czech republic","democratic republic of the congo","denmark","ecuador","egypt","el salvador","estonia","ethiopia","faroe islands","finland","france","georgia","germany","ghana","greece","guatemala","haiti","hong kong sar china","hungary","iceland","india","ireland","israel","italy","japan","kazakhstan","kenya","latvia","lebanon","lesotho","liberia","lithuania","luxembourg","malaysia","malta","mexico","morocco","myanmar","namibia","netherlands","new zealand","nigeria","norway","oman","pakistan","palestinian territories","papua new guinea","peru","philippines","poland","portugal","qatar","romania","russian federation","rwanda","saudi arabia","senegal","serbia","sierra leone","singapore","slovakia","slovenia","south africa","south korea","spain","sweden","switzerland","taiwan","north macedonia","trinidad and tobago","tunisia","turkey","uganda","united kingdom","united arab emirates","tanzania","uruguay","united states","vietnam","zambia"],[31833784.67,44936659,25347233.33,8879101.67,287010.67,9412831.67,11486758.33,63911.67,211026082.67,6978271,20325375.67,25879504,37567839.33,4747106,18932470,1407144787.33,50294461,5047039.33,4066925.33,11332748.67,1198399,10666552,86806688,5813154,17367025.33,100382027,6453497,1326103.67,112088906.67,48679.67,5522224.67,67243588,3723142,83053205,30419303.67,10718340,16603103,11262931.67,7480066.67,9765618,359915.67,1366354808,4929110,9050633.33,59866789.33,126210017.33,18514855,52579279,1913815,6846853,2125282,4938009,2796855,619456.67,31947940,501341.33,127566354.67,36470471,54054511.33,2494580,17339332.67,4988066.67,200992625,5346429,4970363.33,216561978.67,4685887.33,8776490,32490524.33,108116367,37946431.67,10289055.33,2831604.33,19367712.67,144329400,12627038.67,34261717.67,16298205.33,6942321.67,7813447,5676017.33,5453248.33,2088232.67,58553159,51728706.33,47098670,10269181,8575390,23772370.33,2075147.33,1394767,11692847.33,83369588,44246539.67,66837321.33,9763964,58017706,3461582.67,328889744,96448883.33,17865568],[0.67,2.33,107.33,10.67,0.33,0.67,11,0,13.33,0.33,0.33,0.33,74.33,0.33,2,12.33,2.67,0,1,0,0.33,24,0.33,13,0.33,0.67,0.33,6.33,1,0,9.33,33.67,0,135,0.33,2.33,0,0.33,0,2.67,1.33,9.33,10,11.67,7.33,4,0.67,1,3,0.33,0.67,0.33,0.67,1,1,0,1.33,0.33,0.33,0,40,42,0.67,38.67,0.33,0.67,0,0.33,0,4.33,11.67,4.33,0.33,0.67,7.33,0.67,0.67,0.33,0.33,0.33,10,2,0.33,5.33,2,11.67,24.33,41.67,0,0.67,0.33,0.67,0.67,1.67,265.67,2.33,0.33,0,685.33,0.67,0.67],[0.01,0.07,3.88,1.24,0,0.04,0.95,0,0.05,0,0.02,0,1.8,0.14,0.16,0.01,0.08,0,0.16,0,0.55,2.62,0,2.13,0.02,0.01,0.1,5.53,0.01,0,1.75,0.68,0,1.55,0.02,0.12,0,0.06,0,0.38,5.7,0.01,2.38,1.43,0.12,0.04,0.05,0.03,0.86,0,0.32,0,0.24,2.17,0.03,0,0.01,0,0,0,2.67,9.33,0,8.52,0.07,0,0,0.04,0,0.06,0.26,0.42,0,0.02,0.05,0.05,0.02,0,0,0,1.92,0.37,0.32,0.12,0.03,0.22,1.93,5.01,0,0,0.48,0.06,0,0.05,3.75,0.27,0.01,0,2.02,0.01,0],[-17.78,-7.9,230.03,26.39,200.03,-18.31,26.57,287.38,4.09,-2.39,-11.5,-21.77,218.77,-26.95,-10.07,107.11,-6.36,0.32,0.9,-16.43,13.22,1.8,-19.74,26.14,-9.7,22.45,-17.09,1.59,4.84,-17.28,16.85,19.3,0.29,30.02,-5.63,9.29,-26.04,-31.3,29.78,-0.26,19.19,91.81,275.64,19.16,25.69,17.96,4.74,-18.2,-6.53,-12.6,-25.28,-25.75,5.77,123.12,6.45,237.06,-4.31,-17.11,-8.81,-15.98,23.24,218.04,10.44,32.67,12.78,14.12,-16.88,-22.14,-13.42,-4.27,14.17,12.91,89.92,14.89,9.68,-12.39,48.34,-22.76,-12.69,-25.21,102.06,-5.64,3.42,-5.34,6.6,1.89,11.77,40.57,-15.27,-8.08,206.58,-5.83,23.37,-22.57,229.43,60.4,-8.05,1.86,278.4,-18.47,-22.94],[18.45,10.23,-122.69,-15.72,-199.69,18.98,-15.57,-287.38,9.24,2.72,11.83,22.1,-144.44,27.29,12.07,-94.78,9.03,-0.32,0.1,16.43,-12.88,22.2,20.07,-13.14,10.03,-21.78,17.43,4.74,-3.84,17.28,-7.51,14.37,-0.29,104.98,5.96,-6.96,26.04,31.63,-29.78,2.93,-17.86,-82.48,-265.64,-7.49,-18.36,-13.96,-4.07,19.2,9.53,12.93,25.94,26.08,-5.1,-122.12,-5.45,-237.06,5.65,17.44,9.15,15.98,16.76,-176.04,-9.77,6,-12.44,-13.46,16.88,22.48,13.42,8.61,-2.5,-8.57,-89.59,-14.22,-2.35,13.06,-47.67,23.09,13.02,25.54,-92.06,7.64,-3.08,10.67,-4.6,9.77,12.57,1.1,15.27,8.75,-206.25,6.5,-22.71,24.23,36.24,-58.07,8.39,-1.86,406.93,19.13,23.61],[-0.99,0.41,-24.12,-22.97,-90.26,23.19,-0.36,-101.1,-10.52,9.8,7.53,1.95,-51.42,6.13,7.82,-67.07,-4.71,4.09,-1.6,3.44,-0.88,24.2,0.71,-39.76,0.62,5.86,2.35,0.35,-9.81,5,-25.16,0.91,5.23,89.1,10.71,-8.88,-2.44,2.44,4.42,-8.01,-47.39,-73.44,-124.81,19.06,-19.82,-21.22,11.04,3.54,5.77,8.33,5.01,9.48,0.9,-6.22,6.81,-96.8,-0.38,6.15,16.98,1.89,10.03,-88.65,6.71,-11.06,-3.36,10.13,4.69,6.24,7.61,7.45,-0.98,-11.31,-10.86,-2.22,15.38,6.83,-3.02,5.02,10.94,9.44,-4.56,5.97,-27.48,7.93,21.48,-14.82,-18.91,8.1,3.33,3.34,-95.02,13.09,-5.88,0.18,130.83,-5.28,2.75,2.4,541.35,9.02,2.11],[0.28,-0.33,-0.4,-1.3,-2.55,0.31,-0.62,-3.23,-0.28,-0.2,0.41,0.08,-2.15,0.05,0.02,0.34,0.05,-0.44,-0.81,-0.11,-0.29,1.69,-0.09,-1.28,0.27,0.71,0.15,4.38,0.23,-0.18,-0.78,-1.17,0.18,-1.2,-0,-0.96,-0.42,-0.01,-0.92,-0.76,2.5,0.05,-2.36,0.63,-1.33,-1.15,0.47,-0.14,0.12,-0.16,0.33,-0.4,-0.65,0.49,-0.5,-2.69,0.08,0.36,1.06,0.05,-0.01,5.03,0.37,5.13,0.07,0.81,-0.18,-0.17,0.17,-0.4,-0.88,-0.83,-0.74,-0.66,0.36,0.59,0.21,-0.12,-0.6,-0.42,-0.03,-0.26,-1.64,-0.31,-0.14,-1.36,-1.24,2.48,-0.17,-0.27,-2.13,0.6,0.06,0.34,-0.53,-0.27,0.6,-0.32,-1.95,0.22,0.15],[0.07,-0.39,0.73,-1.4,-1.09,0.44,-0.51,-1.55,-0.53,-0.09,0.42,-0.03,-1.07,0.02,-0.02,0.35,-0.14,-0.33,-0.74,-0.14,-0.13,1.72,-0.12,-1.53,0.14,0.86,0.05,4.38,0.13,-0.17,-0.93,-1.39,0.21,-1.39,0.21,-0.94,-0.56,-0.16,-0.71,-0.83,2.22,-0.01,-1.07,0.93,-1.46,-1.34,0.49,-0.13,0.16,-0.1,0.25,-0.28,-0.57,1.05,-0.32,-1.21,-0.01,0.27,1.1,-0.05,-0.04,6.12,0.62,4.93,-0.05,1.06,-0.17,-0.14,0.16,-0.19,-0.85,-0.87,-0.59,-0.56,0.45,0.53,0.25,-0.13,-0.41,-0.29,0.4,-0.22,-1.85,-0.19,0.11,-1.63,-1.47,2.4,-0.17,-0.27,-0.77,0.65,0.05,0.13,0.58,-0.18,0.51,-0.27,-0.66,0.23,0.01],[0.01,0.07,3.88,1.24,-0,0.04,0.95,-0,0.05,-0,0.02,-0,1.8,0.14,0.16,0.01,0.08,-0,0.16,-0,0.55,2.62,-0,2.13,0.02,0.01,0.1,5.53,0.01,-0,1.75,0.68,-0,1.55,0.02,0.12,-0,0.06,-0,0.38,5.7,0.01,2.38,1.43,0.12,0.04,0.05,0.03,0.86,-0,0.32,-0,0.24,2.17,0.03,-0,0.01,-0,-0,-0,2.67,9.33,0,8.52,0.07,0,-0,0.04,-0,0.06,0.26,0.42,-0,0.02,0.05,0.05,0.02,-0,-0,-0,1.92,0.37,0.32,0.12,0.03,0.22,1.93,5.01,-0,-0,0.48,0.06,-0,0.05,3.75,0.27,0.01,-0,2.02,0.01,-0],[0.01,0.07,3.88,1.24,-0,0.04,0.95,-0,0.05,-0,0.02,-0,1.8,0.14,0.16,0.01,0.08,-0,0.16,-0,0.55,2.62,-0,2.13,0.02,0.01,0.1,5.53,0.01,-0,1.75,0.68,-0,1.55,0.02,0.12,-0,0.06,-0,0.38,5.7,0.01,2.38,1.43,0.12,0.04,0.05,0.03,0.86,-0,0.32,-0,0.24,2.17,0.03,-0,0.01,-0,-0,-0,2.67,9.33,0,8.52,0.07,0,-0,0.04,-0,0.06,0.26,0.42,-0,0.02,0.05,0.05,0.02,-0,-0,-0,1.92,0.37,0.32,0.12,0.03,0.22,1.93,5.01,-0,-0,0.48,0.06,-0,0.05,3.75,0.27,0.01,-0,2.02,0.01,-0],[2.94,1.14,102.56,7.71,1.4,1.39,8.75,0.53,11.97,0.53,2.87,1.83,69.65,3.92,1.81,9.96,2.98,0.16,0.48,0.86,0.81,22.68,1.61,9.65,2.07,1.02,2.08,6.37,2.01,4.75,6.81,30.12,1.77,130.25,0.83,0.97,0.25,2.39,-1.24,1.35,0.27,7.17,5.86,10.53,4.22,0.87,1.85,1.16,3.32,1,4.14,2.95,0.39,0.76,-0.53,-0.24,0.46,1.63,3.48,2.4,36.41,38.51,0.44,35.36,2.7,1.31,1.36,1.8,0.29,2.9,9.22,2.75,1.06,-0.69,6.2,4.12,2.74,1.71,0.13,2.46,7.72,1.7,-0.75,4.01,0.24,8.86,20.83,38.73,0.17,1.99,-0.28,2.5,-0.11,4.43,260.21,2.03,2.88,0.64,678.81,0.44,2.79],[2.89,1.05,102.66,7.78,1.6,1.36,8.82,1.21,11.82,0.56,2.45,1.47,69.71,3.29,1.83,9.67,2.99,0.19,0.53,0.68,0.98,22.72,0.82,9.72,2.11,1,2,6.52,1.58,4.9,6.88,30.08,1.87,130.17,0.49,0.99,0,1.99,-1.09,1.37,0.51,6.64,6.17,10.59,4.22,0.83,2.06,0.71,3.42,0.93,3.82,2.35,0.52,1.26,-0.6,0.19,0.36,1.46,3.35,2.42,36.4,38.67,-0,35.45,3.15,0.92,1.21,1.44,0.16,2.5,9.18,2.8,1.65,-0.67,6.18,3.81,3.37,1.28,0.02,1.86,8.02,1.75,-0.63,3.76,0.21,8.82,20.82,38.85,-0.07,2.05,-0.07,2.5,-0,4.07,260.23,2.42,2.57,0.74,678.82,0.1,2.47]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>country<\/th>\n      <th>population_3yr_avg<\/th>\n      <th>eas_3yr_avg<\/th>\n      <th>easpercap_permil<\/th>\n      <th>pred_linear<\/th>\n      <th>resid_linear<\/th>\n      <th>resid_linear_i<\/th>\n      <th>resid_permln<\/th>\n      <th>resid_permln_i<\/th>\n      <th>resid_log_per<\/th>\n      <th>resid_log_per_i<\/th>\n      <th>resid_psn<\/th>\n      <th>resid_psn_i<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3,4,5,6,7,8,9,10,11,12,13]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br>
</p>

<!-- -->

</section>
</section>

<div id="quarto-appendix" class="default"><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p>More careful work could do linear or nearest-neighbor imputation, or a specific model of missingness. We should also check the sensitivity of our results to these imputations.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>With the tidy modeling tools we would do this more carefully, creating ‘recipes’ etc. I keep it a bit simpler for now. If we end up running more models and comparisons we may want to automate this more.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb27" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="an">project:</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">  type: website</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">  output-dir: docs/vignettes</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="co">    citations-hover: true</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co">    footnotes-hover: true</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co">    margin-right: .2em</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co">    freeze: auto # re-render only when source changes</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a><span class="co">    warning: false</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co">    message: false</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co">    error: true</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="an">comments:</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a><span class="co">    hypothesis: true</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># EAS by country: understanding drivers, the search for outliers and untapped 'markets' </span></span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>here <span class="ot">&lt;-</span> here<span class="sc">::</span><span class="fu">here</span>()</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>filter <span class="ot">&lt;-</span> dplyr<span class="sc">::</span>filter</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rnoodling)</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rethinkpriorities)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(broom,  dplyr, ggplot2,  ggrepel, janitor, kableExtra, readr, tidyr, tidyselect, tidymodels, tidyverse, plotly, DT,  <span class="at">install =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(huxtable)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(modelr)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(httr)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(viridis, ggsci)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bring in country level data (input by hand, etc)</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r input_eapercap}</span></span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span></span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_csv</span>(</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"supplementary"</span>, <span class="st">"EAs per capita across time - Compiled Dataset.csv"</span>), <span class="at">skip=</span><span class="dv">1</span>, <span class="at">na=</span><span class="fu">c</span>(<span class="st">"N/A"</span>))</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(across(matches("GDP|"), as.numeric)) %&gt;% </span></span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">easpercap =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(EAspercapita_2018, EAspercapita_2019, EAspercapita_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_easpercap =</span> <span class="fu">log</span>(easpercap),</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">eas_3yr_avg =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(EAs_2018, EAs_2019, EAs_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">population_3yr_avg =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(Population_2018, Population_2019, Population_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdpppp_3yr_avg =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(GDPPPP_2018, GDPPPP_2019, GDPPPP_2020), <span class="at">na.rm=</span><span class="cn">TRUE</span>)),</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">gdppop_3yr_avg =</span>  gdpppp_3yr_avg<span class="sc">/</span>population_3yr_avg</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Further English language features and imputation</span></span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>UK Government classification of 'majority native English speaking' according to <span class="co">[</span><span class="ot">university websites</span><span class="co">](https://www.northampton.ac.uk/international/english-language-requirements/majority-native-english-speaking-countries/)</span>.</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>uk_govt_classified_english_speaking <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"supplementary"</span>, <span class="st">"uk_govt_classified_english_speaking.csv"</span>),</span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_names =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">country=</span><span class="fu">tolower</span>(X1)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_uk_english =</span><span class="dv">1</span>)</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(uk_govt_classified_english_speaking, <span class="at">by=</span><span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">d_uk_english =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a>    country<span class="sc">==</span><span class="st">"united states"</span> <span class="sc">~</span> <span class="cn">TRUE</span>, <span class="co">#USA named differently in other data, needed fixing</span></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a>    country<span class="sc">==</span><span class="st">"bermuda"</span> <span class="sc">~</span> <span class="cn">TRUE</span>, <span class="co">#an obvious omission</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(d_uk_english) <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">FALSE</span></span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>The following dataset is extracted from <span class="ot">&lt;https://en.wikipedia.org/wiki/EF_English_Proficiency_Index&gt;</span>, through a <span class="co">[</span><span class="ot">Kaggler</span><span class="co">](https://www.kaggle.com/datasets/mathurinache/ef-english-proficiency-index?resource=download)</span>.</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r epi_input}</span></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>EF_English_Proficiency_Index <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"supplementary"</span>, <span class="st">"EF_English_Proficiency_Index.csv"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"ef_epi_19"</span><span class="ot">=</span> <span class="st">`</span><span class="at">2019 Score</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">country=</span><span class="fu">tolower</span>(Country),</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">country =</span> <span class="fu">case_when</span>(</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"mainland china"</span> <span class="sc">~</span> <span class="st">"china"</span>,</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"russia"</span> <span class="sc">~</span> <span class="st">"russian federation"</span>,</span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>        country <span class="sc">==</span> <span class="st">"hong kong"</span> <span class="sc">~</span> <span class="st">"hong kong sar china"</span>,</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> country</span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">%&gt;%</span> </span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(country, ef_epi_19)</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a>The two English prevalence/proficiency measures cover different countries, each with many missing values. As a compromise measure, we average these two, taking the nonmissing value of one where the other is missing, a feature we call <span class="in">`english_av`</span>. Finally, where both are missing for a country, we take the average of the above average for the "Cultural Zone" of the country. (Code chunk below).</span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r english_av}</span></span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(EF_English_Proficiency_Index, <span class="at">by=</span><span class="st">"country"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">english_speakers_pctl =</span> <span class="fu">rank</span>(EnglishSpeakers, <span class="at">ties.method =</span> <span class="fu">c</span>(<span class="st">"average"</span>), <span class="at">na.last=</span><span class="st">"keep"</span>)<span class="sc">/</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(EnglishSpeakers)),</span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a>    <span class="at">ef_epi_19_pctl =</span> <span class="fu">rank</span>(ef_epi_19, <span class="at">ties.method =</span> <span class="fu">c</span>(<span class="st">"average"</span>), <span class="at">na.last=</span><span class="st">"keep"</span>)<span class="sc">/</span><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(ef_epi_19)),</span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>eas_by_country_all<span class="sc">$</span>english_av <span class="ot">&lt;-</span> </span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowMeans</span>(eas_by_country_all <span class="sc">%&gt;%</span> <span class="fu">select</span>(ef_epi_19_pctl, english_speakers_pctl) <span class="sc">%&gt;%</span> as.matrix, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> <span class="co">#impute to regional average where missing</span></span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CulturalZone) <span class="sc">%&gt;%</span></span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">english_av_zone =</span> <span class="fu">mean</span>(english_av, <span class="at">na.rm=</span><span class="cn">TRUE</span>),</span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a>    <span class="at">english_av =</span> <span class="fu">case_when</span>(<span class="fu">is.na</span>(english_av) <span class="sc">~</span> english_av_zone,</span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> english_av)</span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a><span class="co"># next take the average of the nonmissing percentiles</span></span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>What does this look like:</span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r english_shown}</span></span>
<span id="cb27-139"><a href="#cb27-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-140"><a href="#cb27-140" aria-hidden="true" tabindex="-1"></a>eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb27-141"><a href="#cb27-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(country, <span class="fu">matches</span>(<span class="st">"english|English|ef_"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-142"><a href="#cb27-142" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="fu">across</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-143"><a href="#cb27-143" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">class =</span> <span class="st">'cell-border stripe'</span>)</span>
<span id="cb27-144"><a href="#cb27-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-145"><a href="#cb27-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-146"><a href="#cb27-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-147"><a href="#cb27-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-148"><a href="#cb27-148" aria-hidden="true" tabindex="-1"></a><span class="fu">### Other imputation </span></span>
<span id="cb27-149"><a href="#cb27-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-150"><a href="#cb27-150" aria-hidden="true" tabindex="-1"></a>We quickly impute all other features where missing by taking the average for the "Cultural Zone" (relevant for below models: <span class="in">`Emancipative`</span> and <span class="in">`Secular`</span>). The data frame with imputed values is called <span class="in">`eas_by_country_all_i`</span>, the one without imputations is <span class="in">`eas_by_country_all`</span>.^<span class="co">[</span><span class="ot">More careful work could do linear or nearest-neighbor imputation, or a specific model of missingness. We should also check the sensitivity of our results to these imputations.</span><span class="co">]</span></span>
<span id="cb27-151"><a href="#cb27-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-152"><a href="#cb27-152" aria-hidden="true" tabindex="-1"></a><span class="in">```{r imputation}</span></span>
<span id="cb27-153"><a href="#cb27-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-154"><a href="#cb27-154" aria-hidden="true" tabindex="-1"></a><span class="co">#imputation where missing</span></span>
<span id="cb27-155"><a href="#cb27-155" aria-hidden="true" tabindex="-1"></a>eas_by_country_all_i <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb27-156"><a href="#cb27-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(CulturalZone) <span class="sc">%&gt;%</span></span>
<span id="cb27-157"><a href="#cb27-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">median</span>(x, <span class="at">na.rm =</span> T), x)) <span class="sc">%&gt;%</span></span>
<span id="cb27-158"><a href="#cb27-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb27-159"><a href="#cb27-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-160"><a href="#cb27-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-161"><a href="#cb27-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-162"><a href="#cb27-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-163"><a href="#cb27-163" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simple models</span></span>
<span id="cb27-164"><a href="#cb27-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-165"><a href="#cb27-165" aria-hidden="true" tabindex="-1"></a>I typically like to define the 'key features' and 'key outcomes' up top. I started on this here, but didn't do it too much.^<span class="co">[</span><span class="ot">With the tidy modeling tools we would do this more carefully, creating 'recipes' etc. I keep it a bit simpler for now. If we end up running more models and comparisons we may want to automate this more.</span><span class="co">]</span></span>
<span id="cb27-166"><a href="#cb27-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-167"><a href="#cb27-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r modelprep}</span></span>
<span id="cb27-168"><a href="#cb27-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-169"><a href="#cb27-169" aria-hidden="true" tabindex="-1"></a><span class="co">#key features</span></span>
<span id="cb27-170"><a href="#cb27-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-171"><a href="#cb27-171" aria-hidden="true" tabindex="-1"></a>features_percap <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"gdppop_3yr_avg"</span>, <span class="st">"d_uk_english"</span>, <span class="st">"english_av"</span>, <span class="st">"Emancipative"</span>, <span class="st">"Secular"</span>)</span>
<span id="cb27-172"><a href="#cb27-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-173"><a href="#cb27-173" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"population_3yr_avg"</span>, features_percap)</span>
<span id="cb27-174"><a href="#cb27-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-175"><a href="#cb27-175" aria-hidden="true" tabindex="-1"></a>log_features_percap <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"log(gdppop_3yr_avg)"</span>, <span class="st">"d_uk_english"</span>, <span class="st">"log(english_av)"</span>,  <span class="st">"log(Emancipative)"</span>, <span class="st">"log(Secular)"</span>)</span>
<span id="cb27-176"><a href="#cb27-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-177"><a href="#cb27-177" aria-hidden="true" tabindex="-1"></a>log_features <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">"log(population_3yr_avg)"</span>, log_features_percap)</span>
<span id="cb27-178"><a href="#cb27-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-179"><a href="#cb27-179" aria-hidden="true" tabindex="-1"></a><span class="co">#This makes complete cases only:</span></span>
<span id="cb27-180"><a href="#cb27-180" aria-hidden="true" tabindex="-1"></a><span class="co">#eas_by_country_all_nomissing &lt;- eas_by_country_all %&gt;%  na.omit(features)</span></span>
<span id="cb27-181"><a href="#cb27-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-182"><a href="#cb27-182" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(eas_by_country_all) <span class="ot">&lt;-</span> eas_by_country_all<span class="sc">$</span>country  </span>
<span id="cb27-183"><a href="#cb27-183" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(eas_by_country_all_i) <span class="ot">&lt;-</span> eas_by_country_all_i<span class="sc">$</span>country  </span>
<span id="cb27-184"><a href="#cb27-184" aria-hidden="true" tabindex="-1"></a><span class="co">#Using rownames is an annoying workaround to get labels in graphs later. There's probably a better way.</span></span>
<span id="cb27-185"><a href="#cb27-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-186"><a href="#cb27-186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-187"><a href="#cb27-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-188"><a href="#cb27-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-189"><a href="#cb27-189" aria-hidden="true" tabindex="-1"></a>Below, we construct models </span>
<span id="cb27-190"><a href="#cb27-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-191"><a href="#cb27-191" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>imputed and complete-case-only data, </span>
<span id="cb27-192"><a href="#cb27-192" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>with linear, log transformations, and exponential (quasi-Poisson) specifications</span>
<span id="cb27-193"><a href="#cb27-193" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>with level and per-capita outcomes.</span>
<span id="cb27-194"><a href="#cb27-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-195"><a href="#cb27-195" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lm_ea_all}</span></span>
<span id="cb27-196"><a href="#cb27-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-197"><a href="#cb27-197" aria-hidden="true" tabindex="-1"></a>model_linear <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb27-198"><a href="#cb27-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, features), .) </span>
<span id="cb27-199"><a href="#cb27-199" aria-hidden="true" tabindex="-1"></a>model_linear_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, features), .) </span>
<span id="cb27-200"><a href="#cb27-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-201"><a href="#cb27-201" aria-hidden="true" tabindex="-1"></a>model_log_eapercap <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb27-202"><a href="#cb27-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(easpercap<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-203"><a href="#cb27-203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"log_easpercap"</span>, log_features_percap), .) </span>
<span id="cb27-204"><a href="#cb27-204" aria-hidden="true" tabindex="-1"></a>model_log_eapercap_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(easpercap<span class="sc">&gt;</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"log_easpercap"</span>, log_features_percap), .)   </span>
<span id="cb27-205"><a href="#cb27-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-206"><a href="#cb27-206" aria-hidden="true" tabindex="-1"></a>model_eapercap <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span> </span>
<span id="cb27-207"><a href="#cb27-207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"easpercap*1000*100"</span>, features_percap), .)</span>
<span id="cb27-208"><a href="#cb27-208" aria-hidden="true" tabindex="-1"></a>model_eapercap_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">lm</span>(<span class="fu">make_formula</span>(<span class="st">"easpercap*1000*100"</span>, features_percap), .)</span>
<span id="cb27-209"><a href="#cb27-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-210"><a href="#cb27-210" aria-hidden="true" tabindex="-1"></a>model_ea_psn <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span>  <span class="fu">glm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, log_features), <span class="at">family=</span>quasipoisson, <span class="at">data =</span>.) </span>
<span id="cb27-211"><a href="#cb27-211" aria-hidden="true" tabindex="-1"></a>model_ea_psn_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span>  <span class="fu">glm</span>(<span class="fu">make_formula</span>(<span class="st">"eas_3yr_avg"</span>, log_features), <span class="at">family=</span>quasipoisson, <span class="at">data =</span>.) </span>
<span id="cb27-212"><a href="#cb27-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-213"><a href="#cb27-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-214"><a href="#cb27-214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-215"><a href="#cb27-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-216"><a href="#cb27-216" aria-hidden="true" tabindex="-1"></a>We put the coefficients of these models into summary tables below:</span>
<span id="cb27-217"><a href="#cb27-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-218"><a href="#cb27-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ea_by_country_all_models_table}</span></span>
<span id="cb27-219"><a href="#cb27-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-220"><a href="#cb27-220" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-221"><a href="#cb27-221" aria-hidden="true" tabindex="-1"></a>ea_by_country_all_models_table <span class="ot">&lt;-</span> </span>
<span id="cb27-222"><a href="#cb27-222" aria-hidden="true" tabindex="-1"></a><span class="fu">huxreg</span>(</span>
<span id="cb27-223"><a href="#cb27-223" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Linear"</span> <span class="ot">=</span> model_linear, </span>
<span id="cb27-224"><a href="#cb27-224" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span> model_linear_i,</span>
<span id="cb27-225"><a href="#cb27-225" aria-hidden="true" tabindex="-1"></a>  <span class="st">"log per-capita, no 0's"</span> <span class="ot">=</span> model_log_eapercap, </span>
<span id="cb27-226"><a href="#cb27-226" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span>  model_log_eapercap_i,</span>
<span id="cb27-227"><a href="#cb27-227" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Per `100k` capita"</span> <span class="ot">=</span> model_eapercap, </span>
<span id="cb27-228"><a href="#cb27-228" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span> model_eapercap_i, </span>
<span id="cb27-229"><a href="#cb27-229" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Quasi-Poisson"</span> <span class="ot">=</span> model_ea_psn,</span>
<span id="cb27-230"><a href="#cb27-230" aria-hidden="true" tabindex="-1"></a>  <span class="st">"... imputed"</span> <span class="ot">=</span> model_ea_psn_i) <span class="sc">%&gt;%</span> </span>
<span id="cb27-231"><a href="#cb27-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_number_format</span>(<span class="at">row=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">col=</span><span class="sc">-</span><span class="dv">1</span>, <span class="at">value=</span><span class="st">"%#.2f"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-232"><a href="#cb27-232" aria-hidden="true" tabindex="-1"></a>   <span class="fu">set_bold</span>(<span class="dv">1</span>, everywhere) <span class="sc">%&gt;%</span></span>
<span id="cb27-233"><a href="#cb27-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_bottom_border</span>(<span class="dv">1</span>, everywhere) <span class="sc">%&gt;%</span></span>
<span id="cb27-234"><a href="#cb27-234" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_caption_pos</span>(<span class="st">"top"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-235"><a href="#cb27-235" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_caption</span>(<span class="st">"EAs by country: Models"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-236"><a href="#cb27-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">set_col_width</span>(<span class="fu">c</span>(.<span class="dv">25</span>, <span class="fu">rep</span>(.<span class="dv">13</span>,<span class="dv">8</span>)))</span>
<span id="cb27-237"><a href="#cb27-237" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-238"><a href="#cb27-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-239"><a href="#cb27-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-240"><a href="#cb27-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-241"><a href="#cb27-241" aria-hidden="true" tabindex="-1"></a>Next, we add the predicted values to the basic data set (imputed and non), to later make tables of  predictions, and residuals, and share that data </span>
<span id="cb27-242"><a href="#cb27-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-243"><a href="#cb27-243" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eas_by_country_all_m}</span></span>
<span id="cb27-244"><a href="#cb27-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-245"><a href="#cb27-245" aria-hidden="true" tabindex="-1"></a><span class="co">#the repetition for both data sets below is rubbish -- I should use 'map' instead</span></span>
<span id="cb27-246"><a href="#cb27-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-247"><a href="#cb27-247" aria-hidden="true" tabindex="-1"></a>eas_by_country_all_m_i <span class="ot">&lt;-</span> eas_by_country_all_i <span class="sc">%&gt;%</span></span>
<span id="cb27-248"><a href="#cb27-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear, <span class="at">var =</span> <span class="st">"pred_linear"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-249"><a href="#cb27-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear_i, <span class="at">var =</span> <span class="st">"pred_linear_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-250"><a href="#cb27-250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap, <span class="at">var =</span> <span class="st">"pred_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-251"><a href="#cb27-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap_i, <span class="at">var =</span> <span class="st">"pred_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-252"><a href="#cb27-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap, <span class="at">var =</span> <span class="st">"pred_log_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-253"><a href="#cb27-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap_i, <span class="at">var =</span> <span class="st">"pred_log_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-254"><a href="#cb27-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn, <span class="at">var =</span> <span class="st">"pred_psn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-255"><a href="#cb27-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn_i, <span class="at">var =</span> <span class="st">"pred_psn_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-256"><a href="#cb27-256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-257"><a href="#cb27-257" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_pred_log_eapercap_xmil =</span> <span class="fu">exp</span>(pred_log_eapercap)<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb27-258"><a href="#cb27-258" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_eapercap_permil =</span> pred_eapercap<span class="sc">*</span><span class="dv">10</span>,</span>
<span id="cb27-259"><a href="#cb27-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_eapercap_permil_i =</span> pred_eapercap_i<span class="sc">*</span><span class="dv">10</span>,</span>
<span id="cb27-260"><a href="#cb27-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">easpercap_permil =</span> easpercap<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>)</span>
<span id="cb27-261"><a href="#cb27-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-262"><a href="#cb27-262" aria-hidden="true" tabindex="-1"></a>eas_by_country_all_m <span class="ot">&lt;-</span> eas_by_country_all <span class="sc">%&gt;%</span></span>
<span id="cb27-263"><a href="#cb27-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear, <span class="at">var =</span> <span class="st">"pred_linear"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-264"><a href="#cb27-264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_linear_i, <span class="at">var =</span> <span class="st">"pred_linear_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-265"><a href="#cb27-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap, <span class="at">var =</span> <span class="st">"pred_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-266"><a href="#cb27-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_eapercap_i, <span class="at">var =</span> <span class="st">"pred_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-267"><a href="#cb27-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap, <span class="at">var =</span> <span class="st">"pred_log_eapercap"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-268"><a href="#cb27-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_log_eapercap_i, <span class="at">var =</span> <span class="st">"pred_log_eapercap_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-269"><a href="#cb27-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn, <span class="at">var =</span> <span class="st">"pred_psn"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-270"><a href="#cb27-270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_predictions</span>(model_ea_psn_i, <span class="at">var =</span> <span class="st">"pred_psn_i"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-271"><a href="#cb27-271" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-272"><a href="#cb27-272" aria-hidden="true" tabindex="-1"></a>    <span class="at">exp_pred_log_eapercap_xmil =</span> <span class="fu">exp</span>(pred_log_eapercap)<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb27-273"><a href="#cb27-273" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_eapercap_permil =</span> pred_eapercap<span class="sc">*</span><span class="dv">10</span>,</span>
<span id="cb27-274"><a href="#cb27-274" aria-hidden="true" tabindex="-1"></a>    <span class="at">easpercap_permil =</span> easpercap<span class="sc">*</span><span class="dv">1000</span><span class="sc">*</span><span class="dv">1000</span>)</span>
<span id="cb27-275"><a href="#cb27-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-276"><a href="#cb27-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-277"><a href="#cb27-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-278"><a href="#cb27-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-279"><a href="#cb27-279" aria-hidden="true" tabindex="-1"></a><span class="fu">## Plotting predicted versus actual levels and largest 'outliers'</span></span>
<span id="cb27-280"><a href="#cb27-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-281"><a href="#cb27-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-282"><a href="#cb27-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r devplotopts}</span></span>
<span id="cb27-283"><a href="#cb27-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-284"><a href="#cb27-284" aria-hidden="true" tabindex="-1"></a>devplotopts <span class="ot">&lt;-</span> <span class="fu">list</span>( <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">2</span>), </span>
<span id="cb27-285"><a href="#cb27-285" aria-hidden="true" tabindex="-1"></a> <span class="fu">geom_label_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> country),</span>
<span id="cb27-286"><a href="#cb27-286" aria-hidden="true" tabindex="-1"></a>                  <span class="at">box.padding   =</span> <span class="fl">0.3</span>, </span>
<span id="cb27-287"><a href="#cb27-287" aria-hidden="true" tabindex="-1"></a>                  <span class="at">point.padding =</span> <span class="fl">0.4</span>,</span>
<span id="cb27-288"><a href="#cb27-288" aria-hidden="true" tabindex="-1"></a>                  <span class="at">segment.color =</span> <span class="st">'grey50'</span>),</span>
<span id="cb27-289"><a href="#cb27-289" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span><span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">color=</span><span class="st">'grey'</span>),</span>
<span id="cb27-290"><a href="#cb27-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(), </span>
<span id="cb27-291"><a href="#cb27-291" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_color_viridis</span>(<span class="at">option =</span> <span class="st">"H"</span>)</span>
<span id="cb27-292"><a href="#cb27-292" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb27-293"><a href="#cb27-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-294"><a href="#cb27-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-295"><a href="#cb27-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-296"><a href="#cb27-296" aria-hidden="true" tabindex="-1"></a>We plot the predicted and actual numbers (or population shares) of EAs for each country, for most of the models. For each, we first plot the 'complete cases' only, and then the models with imputed missing values of features. </span>
<span id="cb27-297"><a href="#cb27-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-298"><a href="#cb27-298" aria-hidden="true" tabindex="-1"></a>In each case countries above the grey degree line represent 'overperformers'  relative to prediction and those below it 'underperformers'.</span>
<span id="cb27-299"><a href="#cb27-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-300"><a href="#cb27-300" aria-hidden="true" tabindex="-1"></a>We color the country dots based on their Englis prevalence and proficiency score. </span>
<span id="cb27-301"><a href="#cb27-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-302"><a href="#cb27-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-303"><a href="#cb27-303" aria-hidden="true" tabindex="-1"></a><span class="fu">### Linear</span></span>
<span id="cb27-304"><a href="#cb27-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-305"><a href="#cb27-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-306"><a href="#cb27-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model_eapercap_linear}</span></span>
<span id="cb27-307"><a href="#cb27-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-308"><a href="#cb27-308" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-309"><a href="#cb27-309" aria-hidden="true" tabindex="-1"></a>ea_dev_linear <span class="ot">&lt;-</span> model_linear <span class="sc">%&gt;%</span> </span>
<span id="cb27-310"><a href="#cb27-310" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb27-311"><a href="#cb27-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-312"><a href="#cb27-312" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb27-313"><a href="#cb27-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb27-314"><a href="#cb27-314" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span></span>
<span id="cb27-315"><a href="#cb27-315" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear model, log scales): Predicted, actual, no imputation"</span>) </span>
<span id="cb27-316"><a href="#cb27-316" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-317"><a href="#cb27-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-318"><a href="#cb27-318" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-319"><a href="#cb27-319" aria-hidden="true" tabindex="-1"></a>ea_dev_linear_i <span class="ot">&lt;-</span> model_linear_i <span class="sc">%&gt;%</span> </span>
<span id="cb27-320"><a href="#cb27-320" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb27-321"><a href="#cb27-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-322"><a href="#cb27-322" aria-hidden="true" tabindex="-1"></a>        devplotopts <span class="sc">+</span></span>
<span id="cb27-323"><a href="#cb27-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span> </span>
<span id="cb27-324"><a href="#cb27-324" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>) <span class="sc">+</span> </span>
<span id="cb27-325"><a href="#cb27-325" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear, log scales): Predicted, actual, Imputed where missing"</span>) </span>
<span id="cb27-326"><a href="#cb27-326" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-327"><a href="#cb27-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-328"><a href="#cb27-328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-331"><a href="#cb27-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb27-332"><a href="#cb27-332" aria-hidden="true" tabindex="-1"></a>resid_threshold <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb27-333"><a href="#cb27-333" aria-hidden="true" tabindex="-1"></a>minEA_threshold <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb27-334"><a href="#cb27-334" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-335"><a href="#cb27-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-336"><a href="#cb27-336" aria-hidden="true" tabindex="-1"></a>Next we isolate the 'largest positive or negative outliers'; the countries that are most 'surprising' to the model; more than <span class="in">`r resid_threshold`</span> above or below prediction. Here we also leave out countries with fewer than <span class="in">`r minEA_threshold`</span> EAs as well as  fewer than <span class="in">`r minEA_threshold`</span> predicted EAs.   </span>
<span id="cb27-337"><a href="#cb27-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-338"><a href="#cb27-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-339"><a href="#cb27-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r ea_outliers_linear}</span></span>
<span id="cb27-340"><a href="#cb27-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-341"><a href="#cb27-341" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-342"><a href="#cb27-342" aria-hidden="true" tabindex="-1"></a>ea_outliers_linear <span class="ot">&lt;-</span> model_linear <span class="sc">%&gt;%</span></span>
<span id="cb27-343"><a href="#cb27-343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb27-344"><a href="#cb27-344" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb27-345"><a href="#cb27-345" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-346"><a href="#cb27-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span>  devplotopts <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>(eas_3yr_avg), <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb27-347"><a href="#cb27-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb27-348"><a href="#cb27-348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb27-349"><a href="#cb27-349" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear, log scales): Largest residuals, no imputation"</span>) </span>
<span id="cb27-350"><a href="#cb27-350" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-351"><a href="#cb27-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-352"><a href="#cb27-352" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-353"><a href="#cb27-353" aria-hidden="true" tabindex="-1"></a>ea_outliers_linear_i <span class="ot">&lt;-</span> model_linear_i <span class="sc">%&gt;%</span></span>
<span id="cb27-354"><a href="#cb27-354" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb27-355"><a href="#cb27-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb27-356"><a href="#cb27-356" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-357"><a href="#cb27-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span> devplotopts <span class="sc">+</span></span>
<span id="cb27-358"><a href="#cb27-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb27-359"><a href="#cb27-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb27-360"><a href="#cb27-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita (linear, log scales): Largest residuals, Imputed where missing"</span>) </span>
<span id="cb27-361"><a href="#cb27-361" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-362"><a href="#cb27-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-363"><a href="#cb27-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-364"><a href="#cb27-364" aria-hidden="true" tabindex="-1"></a>^[In the final graph above it looks like there are more negative than positive residuals. However, note these are presented on a log scale, and thus the observations above the line are 'more overperforming' than those just below the line.</span>
<span id="cb27-365"><a href="#cb27-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-366"><a href="#cb27-366" aria-hidden="true" tabindex="-1"></a><span class="fu">### Log-log per capita</span></span>
<span id="cb27-367"><a href="#cb27-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-368"><a href="#cb27-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-369"><a href="#cb27-369" aria-hidden="true" tabindex="-1"></a>*(Note, I skipped plotting linear per-capita models for space)*</span>
<span id="cb27-370"><a href="#cb27-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-371"><a href="#cb27-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model_eapercap_log_plot}</span></span>
<span id="cb27-372"><a href="#cb27-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-373"><a href="#cb27-373" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-374"><a href="#cb27-374" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_log <span class="ot">&lt;-</span> model_log_eapercap <span class="sc">%&gt;%</span> </span>
<span id="cb27-375"><a href="#cb27-375" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb27-376"><a href="#cb27-376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-377"><a href="#cb27-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span> log_easpercap, <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb27-378"><a href="#cb27-378" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb27-379"><a href="#cb27-379" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"EAS per capita, log model: Predicted, actual, no imputation"</span>) </span>
<span id="cb27-380"><a href="#cb27-380" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-381"><a href="#cb27-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-382"><a href="#cb27-382" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-383"><a href="#cb27-383" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_log_i <span class="ot">&lt;-</span> model_log_eapercap_i <span class="sc">%&gt;%</span> </span>
<span id="cb27-384"><a href="#cb27-384" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb27-385"><a href="#cb27-385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-386"><a href="#cb27-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>log_easpercap, <span class="at">color=</span>english_av) <span class="sc">+</span> </span>
<span id="cb27-387"><a href="#cb27-387" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb27-388"><a href="#cb27-388" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log EAS per capita: Predicted, actual, Imputed where missing"</span>) </span>
<span id="cb27-389"><a href="#cb27-389" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-390"><a href="#cb27-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-391"><a href="#cb27-391" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-392"><a href="#cb27-392" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_log <span class="ot">&lt;-</span> model_log_eapercap <span class="sc">%&gt;%</span></span>
<span id="cb27-393"><a href="#cb27-393" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb27-394"><a href="#cb27-394" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> .<span class="dv">75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-395"><a href="#cb27-395" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span><span class="dv">10</span> <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span><span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-396"><a href="#cb27-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-397"><a href="#cb27-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>(<span class="st">`</span><span class="at">log_easpercap</span><span class="st">`</span>), <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb27-398"><a href="#cb27-398" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_abline</span>(<span class="at">intercept =</span><span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-399"><a href="#cb27-399" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb27-400"><a href="#cb27-400" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log EAS per capita: Largest residuals, no imputation"</span>) </span>
<span id="cb27-401"><a href="#cb27-401" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-402"><a href="#cb27-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-403"><a href="#cb27-403" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-404"><a href="#cb27-404" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_log_i <span class="ot">&lt;-</span> model_log_eapercap_i <span class="sc">%&gt;%</span></span>
<span id="cb27-405"><a href="#cb27-405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb27-406"><a href="#cb27-406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> .<span class="dv">75</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-407"><a href="#cb27-407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-408"><a href="#cb27-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span><span class="st">`</span><span class="at">log_easpercap</span><span class="st">`</span>, <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb27-409"><a href="#cb27-409" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_abline</span>(<span class="at">intercept =</span><span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb27-410"><a href="#cb27-410" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb27-411"><a href="#cb27-411" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Log EAS per capita: Largest residuals, Imputed where missing"</span>) </span>
<span id="cb27-412"><a href="#cb27-412" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-413"><a href="#cb27-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-414"><a href="#cb27-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-415"><a href="#cb27-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-416"><a href="#cb27-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-417"><a href="#cb27-417" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exponential Quasi-Poisson</span></span>
<span id="cb27-418"><a href="#cb27-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-419"><a href="#cb27-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model_eapercap_qp_plot}</span></span>
<span id="cb27-420"><a href="#cb27-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-421"><a href="#cb27-421" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-422"><a href="#cb27-422" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_qp <span class="ot">&lt;-</span> model_ea_psn <span class="sc">%&gt;%</span> </span>
<span id="cb27-423"><a href="#cb27-423" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb27-424"><a href="#cb27-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-425"><a href="#cb27-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span></span>
<span id="cb27-426"><a href="#cb27-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb27-427"><a href="#cb27-427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb27-428"><a href="#cb27-428" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb27-429"><a href="#cb27-429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP model - EAs: predicted, actual, no imputation"</span>) </span>
<span id="cb27-430"><a href="#cb27-430" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-431"><a href="#cb27-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-432"><a href="#cb27-432" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-433"><a href="#cb27-433" aria-hidden="true" tabindex="-1"></a>ea_dev_percap_qp_i <span class="ot">&lt;-</span> model_ea_psn_i <span class="sc">%&gt;%</span> </span>
<span id="cb27-434"><a href="#cb27-434" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb27-435"><a href="#cb27-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-436"><a href="#cb27-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>english_av) <span class="sc">+</span> </span>
<span id="cb27-437"><a href="#cb27-437" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb27-438"><a href="#cb27-438" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb27-439"><a href="#cb27-439" aria-hidden="true" tabindex="-1"></a>    devplotopts <span class="sc">+</span></span>
<span id="cb27-440"><a href="#cb27-440" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP - EAs: Predicted, actual, Imputed where missing"</span>) </span>
<span id="cb27-441"><a href="#cb27-441" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-442"><a href="#cb27-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-443"><a href="#cb27-443" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-444"><a href="#cb27-444" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_qp <span class="ot">&lt;-</span> model_ea_psn <span class="sc">%&gt;%</span></span>
<span id="cb27-445"><a href="#cb27-445" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all) <span class="sc">%&gt;%</span> </span>
<span id="cb27-446"><a href="#cb27-446" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">.resid =</span>  eas_3yr_avg <span class="sc">-</span> .fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb27-447"><a href="#cb27-447" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb27-448"><a href="#cb27-448" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-449"><a href="#cb27-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-450"><a href="#cb27-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>(eas_3yr_avg), <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb27-451"><a href="#cb27-451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb27-452"><a href="#cb27-452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb27-453"><a href="#cb27-453" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb27-454"><a href="#cb27-454" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP = EAs: Largest residuals, no imputation"</span>) </span>
<span id="cb27-455"><a href="#cb27-455" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-456"><a href="#cb27-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-457"><a href="#cb27-457" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-458"><a href="#cb27-458" aria-hidden="true" tabindex="-1"></a>ea_outliers_percap_qp_i <span class="ot">&lt;-</span> model_ea_psn_i <span class="sc">%&gt;%</span></span>
<span id="cb27-459"><a href="#cb27-459" aria-hidden="true" tabindex="-1"></a>    <span class="fu">augment</span>(<span class="at">newdata=</span>eas_by_country_all_i) <span class="sc">%&gt;%</span> </span>
<span id="cb27-460"><a href="#cb27-460" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">.resid =</span>  eas_3yr_avg <span class="sc">-</span> .fitted) <span class="sc">%&gt;%</span> </span>
<span id="cb27-461"><a href="#cb27-461" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span>(<span class="fu">abs</span>(.resid) <span class="sc">&gt;</span> resid_threshold) <span class="sc">%&gt;%</span> </span>
<span id="cb27-462"><a href="#cb27-462" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(eas_3yr_avg<span class="sc">&lt;</span>minEA_threshold <span class="sc">&amp;</span> .fitted <span class="sc">&lt;</span>minEA_threshold)) <span class="sc">%&gt;%</span>  </span>
<span id="cb27-463"><a href="#cb27-463" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb27-464"><a href="#cb27-464" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span>eas_3yr_avg, <span class="at">color=</span>.resid) <span class="sc">+</span></span>
<span id="cb27-465"><a href="#cb27-465" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span>  </span>
<span id="cb27-466"><a href="#cb27-466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log2'</span>) <span class="sc">+</span></span>
<span id="cb27-467"><a href="#cb27-467" aria-hidden="true" tabindex="-1"></a>   devplotopts <span class="sc">+</span></span>
<span id="cb27-468"><a href="#cb27-468" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"QP - EAss: Largest residuals, Imputed where missing"</span>) </span>
<span id="cb27-469"><a href="#cb27-469" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-470"><a href="#cb27-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-471"><a href="#cb27-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-472"><a href="#cb27-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-473"><a href="#cb27-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-474"><a href="#cb27-474" aria-hidden="true" tabindex="-1"></a><span class="fu">## Table of residuals</span></span>
<span id="cb27-475"><a href="#cb27-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-476"><a href="#cb27-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-477"><a href="#cb27-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tabresid}</span></span>
<span id="cb27-478"><a href="#cb27-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-479"><a href="#cb27-479" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb27-480"><a href="#cb27-480" aria-hidden="true" tabindex="-1"></a>  eas_v_predicted <span class="ot">&lt;-</span> eas_by_country_all_m_i <span class="sc">%&gt;%</span>  </span>
<span id="cb27-481"><a href="#cb27-481" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-482"><a href="#cb27-482" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_linear =</span> eas_3yr_avg <span class="sc">-</span> pred_linear,</span>
<span id="cb27-483"><a href="#cb27-483" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_linear_i =</span> eas_3yr_avg <span class="sc">-</span> pred_linear_i,</span>
<span id="cb27-484"><a href="#cb27-484" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_permln =</span> easpercap_permil <span class="sc">-</span> pred_eapercap_permil,</span>
<span id="cb27-485"><a href="#cb27-485" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_permln_i =</span> easpercap_permil <span class="sc">-</span> pred_eapercap_permil_i,</span>
<span id="cb27-486"><a href="#cb27-486" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_log_per =</span> easpercap_permil <span class="sc">-</span> <span class="fu">exp</span>(pred_log_eapercap),</span>
<span id="cb27-487"><a href="#cb27-487" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_log_per_i =</span> easpercap_permil <span class="sc">-</span> <span class="fu">exp</span>(pred_log_eapercap_i),</span>
<span id="cb27-488"><a href="#cb27-488" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_psn =</span> eas_3yr_avg <span class="sc">-</span> pred_psn,</span>
<span id="cb27-489"><a href="#cb27-489" aria-hidden="true" tabindex="-1"></a>      <span class="at">resid_psn_i =</span> eas_3yr_avg <span class="sc">-</span> pred_psn_i</span>
<span id="cb27-490"><a href="#cb27-490" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span> </span>
<span id="cb27-491"><a href="#cb27-491" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(is.numeric, round, <span class="at">digits =</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-492"><a href="#cb27-492" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(country, population_3yr_avg, eas_3yr_avg, easpercap_permil, pred_linear, <span class="fu">starts_with</span>(<span class="st">"resid_"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb27-493"><a href="#cb27-493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">class =</span> <span class="st">'cell-border stripe'</span>)</span>
<span id="cb27-494"><a href="#cb27-494" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-495"><a href="#cb27-495" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-496"><a href="#cb27-496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb27-497"><a href="#cb27-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-498"><a href="#cb27-498" aria-hidden="true" tabindex="-1"></a>\</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->


</body></html>